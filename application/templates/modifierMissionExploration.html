<html!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- lien de bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.6.0/mdb.min.js"></script>
    

    <!-- notre  fichier css -->
    <link rel="stylesheet" type="text/css" href="/static/style.css">

    <!--notre js-->
    <script src="/static/table.js"></script>

    <title>  Seismos || Modifier les informations d'une mission d'exploration</title>


<body class="BODY">
    {% include 'header.html' %}

    <h2 class="fw-bold mb-2 text-uppercase text-center Titre ">Modifer les informations de la mission d'exploration sismique : {{ donnees['id_mission'] }}</h2>

    <form action="/map" method="POST" novalidate id="map">

        <input class="form-control" type="hidden" id="page" name="page" value="modification" ><br>
        <input class="form-control" type="hidden" id="id_mission" name="id_mission" value="{{ id }}"><br>
        <input class="form-control" type="hidden" id="id" name="id_localisation" value="{{ donnees['_id'] }}"><br>

            
        <div class="container py-3  mb-2 ">
            <div class="card text-white card-custom">
                <div class="card-body p-1  ">
                    <div class="mb-md-3 mt-md-3 ">

                        <div class="row  d-flex justify-content-center align-items-center">
                                <div class="col col-6 col-md-4 col-lg-3 col-xl-5 mapid" >
                                        {{ map_html | safe }}
                                </div>
                        </div> 
                    
                        <div class="row  d-flex justify-content-center align-items-center">

                            
                                <div class="col col-4 col-md-3 col-lg-2 col-xl-3">
                                        <label for="lat">Latitude de centre:</label>
                                        <input class="form-control" type="text" id="lat" name="lat" value="{{ donnees['lat'] }}" style="font-weight: bold;" autocomplete="off">
                                    
                                </div>  

                                <div class="col col-4 col-md-3 col-lg-2 col-xl-3">
                                        <label for="lon">Longitude de centre:</label>
                                        <input class="form-control" type="text" id="lon" name="lon" value="{{ donnees['lon'] }}" style="font-weight: bold;" autocomplete="off">
                                </div>  

                                <div class="col col-4 col-md-3 col-lg-2 col-xl-3">
                                    <label for="rayon">le rayon de la zone:</label>
                                    <input class="form-control" type="text" id="rayon" name="rayon" value="{{ donnees['rayon'] }}" style="font-weight: bold;" autocomplete="off">
                                </div>
                               

                                <div class="d-flex justify-content-center p-3">
                                    <input class="submit btn btn-outline-light btn-lg px-5" type="submit" value="Afficher la zone">
                                </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
       
    </form>
    
    <form action="/update_donnees" method="POST" id="update_donnees">
        {% for donnee in donnees1 %}
            <!--<div class="container py-3  mb-2 ">
                <div class="card text-white card-custom">
                    <div class="card-body p-1  ">
                        <div class="mb-md-3 mt-md-3 ">
                            <input type="hidden" id="Nom" class="form-control" name="id"  value="{{ donnee['_id'] }}" style="font-weight: bold;" >

                            <div class="row  d-flex justify-content-center align-items-center">
                                <div class="col col-12 col-md-8 col-lg-6 col-xl-10">
                                    <label class="form-label" for="Nom">NOM</label>
                                    <input type="text" id="Nom" class="form-control" name="Nom"  value="{{ donnee['Nom'] }}" style="font-weight: bold;" autocomplete="off">
                                </div>
                            </div>
                            <div class="row  d-flex justify-content-center align-items-center">
                                <div class="col col-12 col-md-8 col-lg-6 col-xl-10">
                                    <label class="form-label" for="Objectif">OBJECTIF DE LA MISSION</label>
                                    <input type="text" id="Objectif" class="form-control"  name="Objectif" value="{{ donnee['Objectif'] }}"  style="font-weight: bold;" autocomplete="off">
                                </div>
                            </div>
                            <div class="row  d-flex justify-content-center align-items-center">
                    
                                <div class="col col-6 col-md-4 col-lg-3 col-xl-5">
                                    <label class="form-label"  for="Date_deb">DATE DE DÉBUT </label>
                                    <input type="date" class="form-control" id="Date_deb"  name="Date_deb" value="{{ donnee['Date_deb'] }}"  style="font-weight: bold;" >
                                </div>
                                
                                <div class="col col-6 col-md-4 col-lg-3 col-xl-5">
                                    <label class="form-label"  for="Date_fin">DATE DE FIN </label>
                                    <input type="date" class="form-control" id="Date_fin"  name="Date_fin" value="{{ donnee['Date_fin'] }}"  style="font-weight: bold;" >
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>-->



            <div class="container py-3  mb-2 ">
                <div class="card text-white card-custom">
                    <div class="card-body p-1  ">
                        <div class="mb-md-3 mt-md-3 ">
                            
                            <div class="row  d-flex justify-content-center align-items-center">
                                <div class="col col-4 col-md-2 col-lg-2 col-xl-3">
                                    <input type="hidden" id="Nom" class="form-control" name="id"  value="{{ donnee['_id'] }}" style="font-weight: bold;" >

        
                                    <label class="form-label" for="Nom">NOM</label>
                                    <input type="text" id="Nom" class="form-control" name="Nom"  value="{{ donnee['Nom'] }}" style="font-weight: bold;" autocomplete="off">
                                
                                </div>
                                <div class="col col-4 col-md-2 col-lg-2 col-xl-3">
                                    <label class="form-label"  for="Date_deb">DATE DE DÉBUT </label>
                                    <input type="date" class="form-control" id="Date_deb"  name="Date_deb" value="{{ donnee['Date_deb'] }}"  style="font-weight: bold;" >
                                </div>
        
                                <div class="col col-4 col-md-2 col-lg-2 col-xl-3">
                                    <label class="form-label"  for="Date_fin">DATE DE FIN </label>
                                    <input type="date" class="form-control" id="Date_fin"  name="Date_fin" value="{{ donnee['Date_fin'] }}"  style="font-weight: bold;" >
                                </div>
                            </div>
                            <div class="row  d-flex justify-content-center align-items-center text-center">
                                <div class="col col-12 col-md-8 col-lg-6 col-xl-10 ">
                                    <label class="form-label text-lg-start ms-5 " for="Objectif">OBJECTIF DE LA MISSION</label>                                
                                    <textarea class="border" id="Objectif" name="Objectif" placeholder="Objectif" rows="4"
                                        cols="115">{{ donnee['Objectif'] }}</textarea>
        
                                </div>
                            </div>
                        </div>
        
                    </div>
                </div>
            </div>
        {% endfor %}   

        <div class="container py-3  mb-2">
            <div class="card text-white card-custom">
                <div class="card-body p-1  ">
                    <div class="mb-md-3 mt-md-3 ">

                        <div class="row  d-flex justify-content-center m-3 align-items-center">
                            <div class="col col-12 col-md-8 col-lg-6 col-xl-10">
                                <h5>LE FINANCEMENT</h5>
                                <table id="mon-tableau1" class="table rounded" >
                                    <thead>
                                        <tr>
                                            <th style="display: none;">numero</th>
                                            <th>Financier</th>
                                            <th>budget</th>
                                            <th>date de financement</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for donnee in donnees2 %}
                                        <tr name="tr">
                                            <td style="display: none;"><input id="idf" name="table1donnees" 
                                            class="form-control table-input-costum text-dark" value="{{ donnee['_id'] }}" readonly></td>
                                        
                                            <td><input type="text" id="Financier" name="table1donnees"
                                                    class="form-control table-input-costum text-dark" value=" {{ donnee['Financier'] }}" autocomplete="off"/></td>
                                            <td><input type="text" id="budget" name="table1donnees"
                                                    class="form-control table-input-costum text-dark" value="{{ donnee['budget'] }}" autocomplete="off"/></td>
                                            <td><input type="date" id="date_de_financement" name="table1donnees"
                                                    class="form-control table-input-costum text-dark"  value="{{ donnee['date_de_financement'] }}" autocomplete="off"/></td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                                <div class="d-flex justify-content-center p-3">
                                    <input id="ajouter-ligne1"  class="submit btn btn-outline-light btn-lg px-5" value="Ajouter" readonly>
                                </div>
                                </div>
                            </div>
                            
                            <script>
                                var ajouterLigneBtn1 = document.getElementById("ajouter-ligne1");
                                var table1 = document.getElementById("mon-tableau1");
                                 
                                var tableauDeTableauxoption = [];
    
                                ajouterLigneBtn1.addEventListener("click", function() {
                                    ajouterLigne(table1,0, 3,1, "table1donnees",tableauDeTableauxoption);
                                });
                            </script>
                        
                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="container py-3  mb-2">
            <div class="card text-white card-custom">
                <div class="card-body p-1  ">
                    <div class="mb-md-3 mt-md-3 ">
                    
                        <div class="row  d-flex justify-content-center m-3 align-items-center">
                            <div class="col col-12 col-md-8 col-lg-6 col-xl-10">
                            <h5>ÉQUIPEMENTS</h5>
                            <table  id="mon-tableau2" class="table">
                                <thead >
                                <tr>
                                    
                                    <th >Nom équipement</th>
                                    <th style="display: none;">id</th>
                                    <th >quantite</th>
                                    <th >équipe</th>
                                </tr>
                                </thead>
                                <tbody>
                                    {% for donnee in donnees3 %}
                                        <tr>
                                            
                                            
                                            <td>
                                                    <select class="form-select table-input-costum" aria-label=".form-select-sm example" name="table2donnees">
                                                        <option value="Cameras thermiques"{% if 'Cameras thermiques' == donnee['Nom_equipement'] %}selected{% endif %}>Cameras thermiques</option>
                                                        <option value="Drones"{% if 'Drones' == donnee['Nom_equipement'] %}selected{% endif %}>Drones</option>
                                                        <option value="Générateur d'onde" {% if "Générateur d 'onde" == donnee['Nom_equipement'] %}selected{% endif %}>Générateur d'onde</option>
                                                        <option value="Géophones" {% if 'Géophones' == donnee['Nom_equipement'] %}selected{% endif %}>Géophones</option>
                                                        <option value="GPS" {% if 'GPS' == donnee['Nom_equipement'] %}selected{% endif %}>GPS</option> 
                                                        <option value="véhicules tout-terrain" {% if 'véhicules tout-terrain' == donnee['Nom_equipement'] %}selected{% endif %}>véhicules tout-terrain</option> 
                                                        <option value="Marteuse-piqueuse" {% if 'Marteuse-piqueuse' == donnee['Nom_equipement'] %}selected{% endif %}>Marteuse-piqueuse</option> 
                                                        <option value="Ordinateur" {% if 'Ordinateur' == donnee['Nom_equipement'] %}selected{% endif %}>Ordinateur</option> 
                                                        <option value="Imprimante" {% if 'Imprimante ' == donnee['Nom_equipement'] %}selected{% endif %}>Imprimante</option> 
                                                        <option value="Perceuses" {% if 'Perceuses ' == donnee['Nom_equipement'] %}selected{% endif %}>Perceuses</option> 
                                                        <option value="Sismographe" {% if 'Sismographe ' == donnee['Nom_equipement'] %}selected{% endif %}>Sismographe</option> 
                                                        <option value="Vibrateurs" {% if 'Vibrateurs ' == donnee['Nom_equipement'] %}selected{% endif %}>Vibrateurs</option> 
            
                                                    </select> 
                                            
                                            </td>
                                            <td style="display: none;"><input name="table2donnees" id="idf"
                                                class="form-control table-input-costum text-dark" value="{{ donnee['_id'] }}" readonly></td>
                                            <td><strong><input type="text" class="form-control table-input-costum"
                                                name="table2donnees" value="{{ donnee['quantite'] }}" autocomplete="off"/></strong></td>
                                            <td><strong><input type="text" class="form-control table-input-costum"
                                                name="table2donnees" value="{{ donnee['equipe'] }}" autocomplete="off"/></strong></td>
                                                               
                                        </tr>
                                        
                                    {% endfor %}
                                </tbody>
                            </table>
                            <div class="d-flex justify-content-center p-3">
                                <input id="ajouter-ligne2" class="submit btn btn-outline-light btn-lg px-5"
                                    value="Ajouter" readonly>
                            </div>

                            </div>
                        </div>
                        
                        <script>
                            var ajouterLigneBtn2 = document.getElementById("ajouter-ligne2");
                            var table2 = document.getElementById("mon-tableau2");
                            
                            var tableauDeTableauxoption = [];
                            tableauDeTableauxoption.push(["Cameras thermiques", "Drones" , "Générateur d'onde", "Géophones","GPS" , "véhicules tout-terrain" , "Marteuse-piqueuse" , "Ordinateur" , "Imprimante" , "Perceuses" ,  "Sismographe" , "Vibrateurs"  ]);


                            ajouterLigneBtn2.addEventListener("click", function() {
                                ajouterLigne(table2 , 1 , 3 , 0 , "table2donnees" ,tableauDeTableauxoption); // Appelle la fonction ajouterLigne avec le tableau "mon-tableau1" et 3 cellules
                            });
                        </script>
                    </div>
                </div>
            </div>
        </div>

        <div class="container py-3 mb-2">
            <div class="card text-white card-custom">
              <div class="card-body p-1">
                <div class="mb-md-3 mt-md-3">
                  <div class="row d-flex justify-content-center m-3 align-items-center">
                    <div class="col col-12 col-md-8 col-lg-6 col-xl-10">
                      <h5>DÉFINIR LE CALENDRIER DE LA MISSION</h5>
                      <table id="mon-tableau3" class="table">
                        <thead>
                          <tr>
                            <th>chef équipe</th>
                            <th style="display: none;">id</th>
                            <th>équipe</th>
                            <th>tâche</th>
                            <th>date de debut</th>
                            <th>date de fin</th>
                          </tr>
                        </thead>
                        <tbody>
                          {% set chef_ids = [] %}
                          {% for chef in chefs %}
                            {% set _ = chef_ids.append(chef['_id']) %}
                          {% endfor %}

                          {% for donnee in donnees4 %}
                          <tr>
                            
                            <td>
                                <select class="form-select table-input-costum" aria-label=".form-select-sm example" name="table3donnees">
                                    {% for id in chef_ids %}
                                    {% if id == donnee['chef_equipe'] %}
                                        <option value="{{ id }}" selected>{{ id }}</option>
                                    {% else %}
                                        <option value="{{ id }}">{{ id }}</option>
                                    {% endif %}
                                    {% endfor %}
                                </select>
                                </td>
                            <td style="display: none;"><input name="table3donnees" 
                                    class="form-control table-input-costum text-dark" value="{{ donnee['_id'] }}" readonly></td>        
                            <td><strong><input type="text" class="form-control table-input-costum"
                                name="table3donnees" value="{{ donnee['Nom_equipe'] }}" autocomplete="off"/></strong></td>
                            <td><strong><input type="text" class="form-control table-input-costum"
                                name="table3donnees" value="{{ donnee['tache'] }}" autocomplete="off"/></strong></td>
                            <td><strong><input type="date" class="form-control table-input-costum"
                                name="table3donnees" value="{{ donnee['date_debut'] }}"/></strong></td>
                            <td><strong><input type="date" class="form-control table-input-costum"
                                name="table3donnees" value="{{ donnee['date_fin'] }}"/></strong></td>
                                               
                        </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                      <div class="d-flex justify-content-center p-3">
                        <input id="ajouter-ligne3" class="submit btn btn-outline-light btn-lg px-5" value="Ajouter" readonly>
                      </div>
                    </div>
                  </div>
                  <script>
                            var ajouterLigneBtn3 = document.getElementById("ajouter-ligne3");
                            var table3 = document.getElementById("mon-tableau3");

                            var tableauDeTableaux= [{{ chef_ids|tojson  }}];

                            ajouterLigneBtn3.addEventListener("click", function() {
                                ajouterLigne(table3, 1, 3, 2, "table3donnees", tableauDeTableaux);
                            });
                            </script>
                </div>
              </div>
            </div>
          </div>
          
          <div class="d-flex justify-content-center p-3">
            <input  type="submit"  form="update_donnees" class="submit btn btn-outline-light btn-lg px-5" name="valider" value="valider" >
        </div>
    </form>
    


    <footer class=" footer-custom ">
        <div class="container">
          <div class="row ">
            <div class="col-lg-10 text-center text-lg-start">
              © PFE année universitaire 2022/2023
            </div>
          </div>
        </div>
      </footer>
      
</body>