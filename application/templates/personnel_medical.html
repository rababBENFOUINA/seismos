<html!DOCTYPE html>
  <html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- lien de bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
      integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
      crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
      integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
      crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.6.0/mdb.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>


    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


    <!--lien pour les icones-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />


    <!-- notre  fichier css -->
    <link rel="stylesheet" type="text/css" href="/static/style.css">

    <!--mon js-->
    <script src="/static/table.js"></script>

    <title> Seismos || Enregistrer un patient</title>

  </head>
  {% if poste =="Personnel médical Membre"%}

  <body class="medical">
    {% endif%}
    {% if poste =="Responsable de sécurité Membre"%}

    <body class="securit">
      {% endif%}

      {% include 'header.html' %}

      <section class="d-flex align-items-center justify-content-center" style="margin-bottom: -50px;">
        <div class="container position-relative">
          <div class="row no-gutters justify-content-center">
            <div class="col-md-8 text-center">
              <h2 class="text-black text-uppercase mb-2 welcom" style="color: #f03535;">Information sinistré</h2>
            </div>
          </div>
        </div>
      </section>



      <form action="/ajouter_patient" method="POST" id="printableArea" enctype="multipart/form-data" novalidate>
        <div class="container py-1  " Style="margin-top:5%;">
          <div class="card text-dark card-custom">
            <div class="card-body  ">
              <div class="mb-md-2 mt-md-2 ">
                <div class="row  d-flex justify-content-center align-items-center">
                  <div class="col-md-2 mb-md-0">
                    <img id="profil-img" src="/static/images/per2.jpg" class="card-img-top" alt="profil">
                    <div class="card-body">
                      <input type="file" class="form-control" placeholder="profil" name="profil" id="profil"
                        accept="application/image/*" onchange="replaceImage()">
                      <div Style="margin-top:3%;">
                        <label class="form-label" for="id_mission">Mission</label>
                        <select class="form-select " aria-label=".form-select-sm example" name="id_mission"
                          id="id_mission">
                          <option></option>
                          {% for mission in missions %}
                          <option value="{{ mission['idmission'] }}">{{ mission['idmission'] }}</option>
                          {% endfor %}
                        </select>
                      </div>
                    </div>
                  </div>

                  <div class="col-md-3 mb-md-0">

                    <label class="form-label" for="Index_Patient">Index sinistré</label>
                    <input type="text" class="form-control" placeholder="Index sinistré" aria-label="Index Patient"
                      name="Index_Patient" id="Index_Patient" autocomplete="off">

                    <script>
                      var indexPatientField = document.getElementById("Index_Patient");
                      indexPatientField.addEventListener("dblclick", function (event) {
                        var indexPatientValue = indexPatientField.value;
                        var newUrl = "/chercher_patient?indexPatient=" + encodeURIComponent(indexPatientValue);
                        window.location.href = newUrl;
                      });

                    </script>

                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">Prenom</label>
                      {% if messages_erreur.Prenom %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.Prenom }} </p>
                      {% endif %}
                    </div>
                    <input type="text" class="form-control" placeholder="Prenom" aria-label="Prenom" name="Prenom"
                      id="Prenom" autocomplete="off">

                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">Date de naissance</label>
                      {% if messages_erreur.date %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.date }} </p>
                      {% endif %}
                    </div>
                    <input type="Date" class="form-control" placeholder="Date de naissance"
                      aria-label="Date de naissance" name="date" id="date_naissance" autocomplete="off">


                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">CIN</label>
                      {% if messages_erreur.CIN %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.CIN }} </p>
                      {% endif %}
                    </div>
                    <input type="text" class="form-control" placeholder="CIN" aria-label="CIN" name="CIN" id="CIN"
                      autocomplete="off">


                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">Ville</label>
                      {% if messages_erreur.Ville %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.Ville }} </p>
                      {% endif %}
                    </div>
                    <input type="text" class="form-control" placeholder="Ville" aria-label="Ville" name="Ville"
                      id="Ville" autocomplete="off">
                  </div>

                  <div class="col-md-3  mb-md-0">

                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">Nom</label>
                      {% if messages_erreur.Nom %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.Nom }} </p>
                      {% endif %}
                    </div>
                    <input type="text" class="form-control" placeholder="Nom" aria-label="Nom" name="Nom" id="Nom"
                      autocomplete="off">


                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">Sexe</label>
                      {% if messages_erreur.Sexe %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.Sexe }} </p>
                      {% endif %}
                    </div>
                    <select class="form-select " aria-label=".form-select-sm example" name="Sexe" id="Sexe">
                      <option></option>
                      <option value="homme">Homme</option>
                      <option value="femelle">Femme</option>
                    </select>

                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">Âge</label>
                      {% if messages_erreur.Age %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.Age }} </p>
                      {% endif %}
                    </div>
                    <input type="text" class="form-control" placeholder="Âge" aria-label="Âge" name="Age" id="age"
                      autocomplete="off">


                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">Numéro de téléphone</label>
                      {% if messages_erreur.telephone %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.telephone }} </p>
                      {% endif %}
                    </div>
                    <input type="text" class="form-control" placeholder="Numéro de téléphone"
                      aria-label="Numéro de téléphone" name="telephone" id="telephone" autocomplete="off">


                    <div style="display: flex; align-items: center;">
                      <label class="form-label" for="titre_rapport">Pays</label>
                      {% if messages_erreur.Payer %}
                      <p class="erreur NoError md-3"
                        style="display: inline-block; vertical-align: middle; font-weight: bold;">* {{
                        messages_erreur.Payer }} </p>
                      {% endif %}
                    </div>
                    <input type="text" class="form-control" placeholder="Pays" aria-label="Pays" name="Payer"
                      id="Payer" autocomplete="off">
                  </div>
                  <div class="row  d-flex justify-content-center align-items-center">
                    <div class="col-md-2  mb-md-0">
                    </div>
                    <div class="col-md-6  mb-md-0">
                      <label class="form-label" for="Adresse">Adresse</label>
                      <input type="text" class="form-control" placeholder="Adresse" aria-label="Adresse" name="Adresse"
                        id="Adresse" autocomplete="off">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <script>
            function calculerAge() {
              const inputDateNaissance = document.getElementById("date_naissance");
              const inputAge = document.getElementById("age");

              const dateNaissance = new Date(inputDateNaissance.value);
              const maintenant = new Date();
              const age = maintenant.getFullYear() - dateNaissance.getFullYear();

              inputAge.value = age;
            }

            const inputDateNaissance = document.getElementById("date_naissance");
            inputDateNaissance.addEventListener("change", calculerAge);

          </script>



          {% if poste == "Personnel médical Membre" %}
          <div class="container py-1  " Style="margin-top:3%; margin-bottom:3%;">
            <div class="card text-dark card-custom">
              <div class="card-body  ">
                <div class="mb-5 md-2 mt-md-2 ">
                  <div class="row  d-flex justify-content-center align-items-center">
                    <div class="col-md-5 mb-md-0">
                      <label class="form-label" for="Index_Patient">numero de dosier medical</label>
                      <input type="text" class="form-control" placeholder="Numero de dossier medical"
                        name="Numero_dossier_medical" autocomplete="off">


                      <label class="form-label" for="Mode_Transport">Le mode de transport</label>
                      <select class="form-select " aria-label=".form-select-sm example" name="Mode_Transport">
                        <option></option>
                        <option value="Transport par ambulance terrestre">Transport par ambulance terrestre</option>
                        <option value="Transport par hélicoptère">Transport par hélicoptère</option>
                        <option value="Transport par avion">Transport par avion</option>
                        <option value="Transport en ambulance de réanimation">Transport en ambulance de réanimation
                        </option>
                        <option value="Transport en train sanitaire">Transport en train sanitaire</option>
                      </select>

                      <label class="form-label" for="Date_Transport">Date de transport</label>
                      <input type="Date" class="form-control" placeholder="Date de transport"
                        aria-label="Date de transport" name="Date_Transport" autocomplete="off">


                      <label class="form-label" for="Nom_Medcin_Traitant">Nom du médecin traitant</label>
                      <input type="text" class="form-control" placeholder="Nom du médecin traitant"
                        aria-label="Nom du médecin traitant" name="Nom_Medcin_Traitant" autocomplete="off">

                    </div>

                    <div class="col-md-5 mb-md-0">
                      <label class="form-label" for="Service_Medical">Service médical</label>
                      <select class="form-select " aria-label=".form-select-sm example" name="Service_Medical">
                        <option></option>
                        <option value="Dermatologie" name="Service_Medical">Dermatologie</option>
                        <option value="Ophtalmologie" name="Service_Medical">Ophtalmologie</option>
                        <option value="Oto-rhino-laryngologie (ORL)" name="Service_Medical">Oto-rhino-laryngologie (ORL)
                        </option>
                        <option value="Endocrinologie" name="Service_Medical">Endocrinologie</option>
                        <option value="Allergologie" name="Service_Medical">Allergologie</option>
                        <option value="Infectiologie" name="Service_Medical">Infectiologie</option>
                        <option value="Rhumatologie" name="Service_Medical">Rhumatologie</option>
                        <option value="Pneumologie" name="Service_Medical">Pneumologie</option>
                        <option value="Anesthésiologie" name="Service_Medical">Anesthésiologie</option>
                        <option value="Médecine physique et de réadaptation (MPR)" name="Service_Medical">Médecine
                          physique et de réadaptation (MPR)</option>
                      </select>


                      <label class="form-label" for="Hopitale_Destination">Hôpital de destination</label>
                      <input type="text" class="form-control" placeholder="Hôpital de destination"
                        aria-label="Hôpital de destination" name="Hopitale_Destination" autocomplete="off">

                      <label class="form-label" for="Date_Transport">Heure de transport</label>
                      <input type="time" class="form-control" placeholder="Date de transport"
                        aria-label="Date de transport" name="Heur_Transport" autocomplete="off">

                      <label class="form-label" for="Allergies">Nom de l'infirmier responsable</label>
                      <input type="text" class="form-control" placeholder="Nom de l'infirmier responsable"
                        aria-label="Nom de l'infirmier responsable" name="infirmier" autocomplete="off">
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        {% endif %}


        <div class="container py-3  mb-2">
          <div class="card text-white card-custom">
            <div class="card-body p-1  ">
              <div class="mb-md-3 mt-md-3 ">
                <div class="row d-flex justify-content-center m-3 align-items-center">
                  {% if poste == "Personnel médical Membre" %}
                  <div class="col-12 col-md-6 col-lg-6 col-xl-5">
                    <div class="dropdown">
                      <label class="form-label" for="Historique_Médical">Historique Médical</label>
                      <input type="text" class="form-control" placeholder="Historique_Médical"
                        aria-label="Historique_Médical" name="historique_Médical2" id="historique-medical-input"
                        readonly>
                      <ul class="dropdown-menu historique-medical-menu" aria-labelledby="historique-medical-label"
                        style="width: calc(100%); overflow-y: auto; padding: 5%; border-radius: 0.5rem;">
                      </ul>
                    </div>

                    <script>
                      $(document).ready(function () {
                        $('#historique-medical-input').dblclick(function () {
                          var input = $(this);
                          input.focus();
                          var newOption = prompt("Entrez une nouvelle option :");
                          if (newOption && newOption !== "" && $.inArray(newOption, getHistoriqueMedicalValues()) === -1) {
                            $(`<li><input type="checkbox" value="${newOption}" name="Historique_Médical2" checked> ${newOption}</li>`).appendTo('.historique-medical-menu');
                          }
                        });

                        $('#historique-medical-input').click(function () {
                          $('.historique-medical-menu').toggle();
                        });

                        function getHistoriqueMedicalValues() {
                          return $('.historique-medical-menu li input[type="checkbox"]').map(function () {
                            return $(this).val();
                          }).get();
                        }
                      });
                    </script>
                  </div>
                  <div class="col-12 col-md-6 col-lg-6 col-xl-5">
                    <div class="dropdown">
                      <label class="form-label" for="Allergies">Allergies</label>
                      <input type="text" class="form-control" placeholder="Allergies" aria-label="Allergies"
                        name="Allergies" id="allergies-input" readonly>
                      <ul class="dropdown-menu allergies-menu" aria-labelledby="allergies-label"
                        style="width: calc(100%); overflow-y: auto; padding: 5%; border-radius: 0.5rem;">
                      </ul>
                    </div>

                    <script>
                      $(document).ready(function () {
                        $('#allergies-input').dblclick(function () {
                          var input = $(this);
                          input.focus();
                          var newOption = prompt("Entrez une nouvelle option :");
                          if (newOption && newOption !== "" && $.inArray(newOption, getAllergyValues()) === -1) {
                            $(`<li><input type="checkbox" value="${newOption}" name="Allergies1" checked> ${newOption}</li>`).appendTo('.allergies-menu');
                          }
                        });

                        $('#allergies-input').click(function () {
                          $('.allergies-menu').toggle();
                        });

                        function getAllergyValues() {
                          return $('.allergies-menu li input[type="checkbox"]').map(function () {
                            return $(this).val();
                          }).get();
                        }
                      });
                    </script>
                    {% endif%}
                  </div>

                </div>

                <div class="row  d-flex justify-content-center m-3 align-items-center">
                  <div class="col col-12 col-md-8 col-lg-6 col-xl-10">
                    <table id="mon-tableau1" class="table rounded">
                      <thead>
                        <tr>
                          <th class="text-center">Niveau de conscience</th>
                          <th class="text-center">Fréquence cardiaque (bpm)</th>
                          <th class="text-center">Pression artérielle (mmHg)</th>
                          <th class="text-center">Température (°C)</th>
                          <th class="text-center">Respiration (rpm)</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr name="tr">
                          <td>
                            <select class="form-select table-input-costum" aria-label=".form-select-sm example"
                              name="table1donnees">
                              <option></option>
                              <option value="Score de 15">Score de 15</option>
                              <option value="Score de 13-14">Score de 13-14</option>
                              <option value="Score de 9-12">Score de 9-12</option>
                              <option value="Score de 6-8">Score de 6-8</option>
                              <option value="Score de 3-5">Score de 3-5</option>
                            </select>
                          </td>
                          <td><input type="text" id="freq-cardiaque" name="table1donnees"
                              class="form-control table-input-costum" autocomplete="off" /></td>
                          <td><input type="text" id="pression-arterielle" name="table1donnees"
                              class="form-control table-input-costum" autocomplete="off" /></td>
                          <td><input type="text" id="temperature" name="table1donnees"
                              class="form-control table-input-costum" autocomplete="off" /></td>
                          <td><input type="text" id="respiration" name="table1donnees"
                              class="form-control table-input-costum" autocomplete="off" /></td>
                        </tr>
                      </tbody>
                    </table>

                    <div class="d-flex justify-content-center p-3">
                      <input id="ajouter-ligne1" class="submit btn btn-outline-light btn-lg px-5" value="Ajouter"
                        readonly>
                    </div>
                  </div>
                </div>

                <script>
                  var ajouterLigneBtn1 = document.getElementById("ajouter-ligne1");
                  var table1 = document.getElementById("mon-tableau1");

                  var tableauDeTableauxoption1 = [];
                  tableauDeTableauxoption1.push([" ", "Score de 15", "Score de 13-14", "Score de 9-12", "Score de 6-8", "Score de 3-5"]);


                  ajouterLigneBtn1.addEventListener("click", function () {
                    ajouterLignedate(table1, 1, 4, 0, "table1donnees", tableauDeTableauxoption1);
                  });
                </script>


                <div class="row  d-flex justify-content-center m-3 align-items-center">
                  <div class="col col-12 col-md-8 col-lg-6 col-xl-10">
                    <table id="mon-tableau2" class="table">
                      <thead>
                        <tr>
                          <th class="text-center">Type de blessures</th>
                          <th class="text-center">Emplacement des blessures</th>
                          <th class="text-center">Gravité des blessures</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>

                          <td><input type="text" class="form-control table-input-costum" name="table2donnees"
                              autocomplete="off" /></td>
                          <td><input type="text" class="form-control table-input-costum" name="table2donnees"
                              autocomplete="off" /></td>
                          <td><input type="text" class="form-control table-input-costum" name="table2donnees"
                              autocomplete="off" /></td>

                        </tr>
                      </tbody>
                    </table>

                    <div class="d-flex justify-content-center p-3">
                      <input id="ajouter-ligne2" class="submit btn btn-outline-light btn-lg px-5" value="Ajouter"
                        readonly>
                    </div>
                  </div>
                </div>

                <script>
                  var ajouterLigneBtn2 = document.getElementById("ajouter-ligne2");
                  var table2 = document.getElementById("mon-tableau2");

                  var tableauDeTableauxoption = [];


                  ajouterLigneBtn2.addEventListener("click", function () {
                    ajouterLignedate(table2, 0, 3, 0, "table2donnees", tableauDeTableauxoption); // Appelle la fonction ajouterLigne avec le tableau "mon-tableau1" et 3 cellules
                  });
                </script>

                <div class="row  d-flex justify-content-center m-3 align-items-center">
                  <div class="col col-12 col-md-8 col-lg-6 col-xl-10">
                    <label class="form-label" for="autre_soin">autre soin</label>
                    <textarea class="border" id="autre_soin" name="autre_soin" placeholder="autre_soin" rows="4"
                      cols="100"></textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="d-flex justify-content-center p-3">
          <input type="submit" class="submit btn btn-outline-light btn-lg px-5" name="valider" onclick="printForm()"
            value="valider">
        </div>

      </form>

      <footer class=" footer-custom ">
        <div class="container">
          <div class="row ">
            <div class="col-lg-10 text-center text-lg-start">
              © PFE année universitaire 2022/2023
            </div>
          </div>
        </div>
      </footer>
    </body>